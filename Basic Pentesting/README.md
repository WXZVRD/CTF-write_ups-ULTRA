Basic Pentesting — TryHackMe CTF: write-up / README

Краткое описание
Это пошаговый write-up прохождения CTF-комнаты Basic Pentesting (TryHackMe). В работе использованы стандартные инструменты Kali Linux: nmap, gobuster, enum4linux, smbclient, hydra, ssh, ssh2john, john. Цель — найти пользователей, получить доступ по SSH, и выполнить привилегированное повышение до пользователя K для получения финальных артефактов.

Содержимое репозитория

README.md — этот файл (write-up).

notes/ — ваши заметки и сохранённые вспомогательные файлы (например id_rsa, hash.txt, словари).

commands.txt — список исполненных команд (см. раздел «Команды»).

loot/ — файлы/флаги, найденные на машине.

1. Окружение

Kali Linux (локально), подключение к TryHackMe VPN.

Цель: удалённая машина с IP (пример) 10.10.X.X.

Словари: royo.txt (использовался для брутфорса паролей).

2. Что было выполнено (в двух предложениях)

Провёл сканирование сервисов, нашёл веб-директорию development с подсказками, перечислил SMB-шары и получил имена пользователей. Затем подобрал пароль пользователя Jan через брутфорс SSH, собрал приватный ключ пользователя K, извлёк из него хэш и подобрал passphrase, после чего вошёл как K и прочитал финальный файл с паролем/флагом.

3. План / Objectives

Сканирование целевой машины (порты/сервисы).

Перечисление веб-каталога → поиск подсказок.

SMB-энумерация — найти пользователей/файлы.

Брутфорс SSH (найти пароль для Jan).

Достать приватный ключ пользователя K и получить доступ к K (ssh2john → john).

Получить финальные артефакты / флаги.

4. Recon & Enumeration (что и как делал)
4.1 Nmap — быстрое агрессивное сканирование

Команда (пример):

nmap -sS -A -T4 -oN output.txt 10.10.X.X


Результат: открыты порты 22 (SSH), 80 (HTTP), SMB (Samba) и ещё пара портов. Результат сохранил в output.txt.

4.2 Веб — просмотр главной страницы и поиск

Открыл сайт в браузере по IP, просмотрел исходный код — нашёл комментарий с подсказкой про dev notes.

Запустил gobuster для поиска директорий:

gobuster dir -u http://10.10.X.X -w /usr/share/wordlists/dirb/common.txt -t 50


Найдена директория: development.

4.3 Прочитал файлы в development

Внутри — два .txt с диалогом между K и J, упоминания:

Apache настроен.

Samba настроена.

Проверка /etc/shadow.

Версия (2.5.12) — полезная подсказка о возможной уязвимости/контексте.

Из одного файла стало ясно, что имена пользователей — начинаются на J и K (позже выяснилось как Jan и K).

4.4 SMB-перечисление

Использовал enum4linux, затем smbclient:

enum4linux -a 10.10.X.X
smbclient -L //10.10.X.X -N
smbclient //10.10.X.X/anonymous -N


Подключаясь к шаре anonymous, скачал st.txt — внутри подтверждены имена пользователей: Jan и K.

5. Эксплуатация / получение доступа
5.1 Брутфорс SSH для пользователя Jan

Инструмент: hydra.

hydra -l Jan -P /path/to/royo.txt ssh://10.10.X.X -t 4


Результат: найден пароль Arando (или Armando — в транскрипте встречается обе вариации; в реальной сессии проверяйте точное значение).
Подключение:

ssh Jan@10.10.X.X
# вводим найденный пароль

5.2 Получение приватного ключа пользователя K

После входа как Jan:

ls -la /home/K/.ssh
cat /home/K/.ssh/id_rsa


Скопировал приватный ключ id_rsa в локальный файл id_rsa_k.

5.3 Конвертация приватного ключа в формат для crack'а

Использовал ssh2john (часть john tools):

/opt/john/run/ssh2john.py id_rsa_k > hash.txt

5.4 Крэк пароля (passphrase) приватного ключа

Запустил john со словарём:

john --wordlist=/path/to/royo.txt hash.txt


Результат: найден passphrase (в видео — pwax).
Применение ключа:

chmod 600 id_rsa_k
ssh -i id_rsa_k K@10.10.X.X
# при запросе passphrase вводим найденное значение

6. Да, мы в системе K — финал

После входа как K:

cat /home/K/password.txt   # или другой файл, который содержит финальный пароль/флаг


Файл с паролем/флагом прочитан — CTF пройден.